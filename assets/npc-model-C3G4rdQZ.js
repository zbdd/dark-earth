import{c as s}from"./solid-lwVvZ318.js";const D=({code:e,name:t,randomDropWeight:a=50,description:r="No description provided",value:i=1,id:o,collected:l=!1,quantity:d=1,uses:g=0,level:u=1,health:h=0,type:f="loot",damage:v=0,range:A=0,armour:I=0,maxArmour:w})=>{const p=o??Math.random().toString(36).substring(2,15)+"-"+e,[c,m]=s(d),[y,W]=s(I),[S,T]=s(g),[M,E]=s(l);return{code:()=>e,id:()=>p,description:()=>r,randomDropWeight:()=>a,name:()=>t,level:()=>u,collected:()=>M(),setCollected:b=>{E(b)},quantity:()=>c(),value:()=>i,updateQuantity:b=>{m(b)},uses:()=>S(),setUses:b=>{b>=0&&T(b)},health:()=>h,type:()=>f,damage:()=>v,range:()=>A,armour:()=>y(),setArmour:b=>{b>=0&&W(b)},maxArmour:()=>w!==void 0?w:y(),data:()=>({code:e,name:t,randomDropWeight:a,description:r,value:i,quantity:c(),level:u,health:h,type:f,damage:v,range:A,armour:y(),id:p,maxArmour:w!==void 0?w:y(),uses:S(),collected:M()})}},_=[{code:"boots",name:"Boots",level:2,randomDropWeight:50,description:"Basic footwear providing limited protection.",value:1,armour:1,type:"shoes"},{code:"steel-toe-boots",name:"Steel-Toe Boots",level:3,randomDropWeight:25,description:"Heavy-duty boots with reinforced toes. Ideal for kicking and surviving.",value:6,armour:2,type:"shoes"},{code:"leather-sneakers",name:"Leather Sneakers",level:1,randomDropWeight:50,description:"Worn down but flexible. Better than walking barefoot.",value:2,type:"shoes"},{code:"military-greaves",name:"Military Greaves",level:4,randomDropWeight:15,description:"Surplus-grade lower leg armour. Scarred, but solid.",value:7,armour:3,type:"shoes"},{code:"plated-shinwraps",name:"Plated Shinwraps",level:2,randomDropWeight:30,description:"Wrapped in cloth and bolted with scrap metal plates.",value:4,armour:1,type:"shoes"},{code:"cultist-footwraps",name:"Cultist Footwraps",level:1,randomDropWeight:35,description:"Bandages soaked in oil and prayer. Not hygienic.",value:1,type:"loot"},{code:"hazmat-boots",name:"Hazmat Boots",level:3,randomDropWeight:20,description:"Rubberised boots with cracked soles. Resistant to gunk, not teeth.",value:3,armour:1,type:"shoes"},{code:"soggy-slippers",name:"Soggy Slippers",level:0,randomDropWeight:60,description:"Wet, floppy, and morally offensive. Someone still wore these.",value:1,type:"loot"},{code:"tire-tread-sandals",name:"Tire-Tread Sandals",level:2,randomDropWeight:40,description:"Crafted from old tires and wire. Surprisingly durable.",value:3,armour:1,type:"shoes"},{code:"reinforced-waders",name:"Reinforced Waders",level:3,randomDropWeight:25,description:"Heavy waterproof boots reinforced with rivets and curses.",value:5,armour:2,type:"shoes"},{code:"ceremonial-toe-rings",name:"Ceremonial Toe Rings",level:0,randomDropWeight:45,description:"Technically footwear. Spiritually disappointing.",value:1,type:"loot"},{code:"leather-tunic",name:"Leather Tunic",level:4,randomDropWeight:40,description:"A tunic made of leather, providing basic protection.",value:3,armour:1,type:"helmet"},{code:"rusted-helm",name:"Rusted Helm",level:2,randomDropWeight:40,description:"A dented steel helmet from a bygone war. Still offers some protection.",value:3,armour:1,type:"helmet"},{code:"riot-visor",name:"Cracked Riot Visor",level:3,randomDropWeight:30,description:"Half of a riot helmet. The visor is shattered but still provides some defense.",value:4,armour:2,type:"helmet"},{code:"makeshift-helmet",name:"Makeshift Helmet",level:2,randomDropWeight:35,description:"A cooking pot with leather straps. Better than nothing, barely.",value:2,armour:1,type:"helmet"},{code:"military-helmet",name:"Old Military Helmet",level:4,randomDropWeight:15,description:"Kevlar-lined and surprisingly intact. Offers solid protection.",value:7,armour:3,type:"helmet"},{code:"metal-faceplate",name:"Metal Faceplate",level:3,randomDropWeight:20,description:"Welded scrap formed into a crude faceguard. Heavy but effective.",value:4,armour:2,type:"helmet"},{code:"bucket-head",name:"Bucket Head",level:1,randomDropWeight:45,description:"It’s literally just a bucket. Slightly muffles voices and incoming rocks.",value:1,armour:1,type:"helmet"}],J=[{code:"torch",name:"Torch",level:1,randomDropWeight:70,description:"A source of light.",value:.1,type:"light"},{code:"coin",name:"Coin",level:1,randomDropWeight:90,description:"Used to purchase items.",value:1,type:"currency"},{code:"ichor",name:"Ichor",level:8,randomDropWeight:10,description:"A valuable substance used by apothecaries.",value:10},{code:"seedling",name:"Seedling",level:7,randomDropWeight:20,description:"Extremely valuable essence of new life.",value:15},{code:"antigen",name:"Antigen",level:5,randomDropWeight:30,description:"A substance that stimulates the production of antibodies.",value:5},{code:"light-shard",name:"Light Shard",level:10,randomDropWeight:5,description:"A shard of pure light.",value:100},{code:"shirt",name:"Shirt",level:3,randomDropWeight:60,description:"A basic shirt.",value:1},{code:"scavenger-hood",name:"Scavenger Hood",level:1,randomDropWeight:50,description:"A makeshift hood sewn from scraps and duct tape. Blocks sunlight, not bullets.",value:1,type:"loot"},{code:"cult-mask",name:"Bone Cult Mask",level:2,randomDropWeight:20,description:"A decorative skull mask worn by wasteland cultists. Intimidating, not useful.",value:2,type:"loot"},{code:"bandana",name:"Worn Bandana",level:0,randomDropWeight:60,description:"Faded and threadbare. A nod to fashion, not function.",value:1,type:"loot"},{code:"hazmat-hood",name:"Hazmat Hood (Torn)",level:3,randomDropWeight:25,description:"A scorched hood from an old hazmat suit. Still filters some toxins.",value:5,type:"loot"}],X=[{code:"spear",name:"Spear",level:3,randomDropWeight:40,description:"A long weapon for thrusting.",value:2,type:"weapon",damage:1,range:2},{code:"knuckle-duster",name:"Knuckle Duster",level:3,randomDropWeight:40,description:"A metal knuckle for close combat.",value:2,type:"weapon",damage:2,range:1},{code:"sword",name:"Sword",level:5,randomDropWeight:30,description:"A sharp blade for slashing.",value:6,type:"weapon",damage:3,range:1},{code:"knife",name:"Knife",level:2,randomDropWeight:50,description:"A sharp blade for cutting.",value:1,type:"weapon",damage:2,range:1},{code:"bow",name:"Bow",level:4,randomDropWeight:35,description:"A good ranged weapon.",value:3,type:"weapon",damage:2,range:3}],Z=[{code:"healing-potion",name:"Healing Potion",level:3,randomDropWeight:50,description:"A potion that restores health.",value:6,health:3,type:"consumable"},{code:"city-key",name:"City Key",type:"key",level:0,randomDropWeight:0,description:"A key that unlocks the city gates.",value:0},{code:"waterskin",name:"Waterskin",level:2,randomDropWeight:60,description:"Contains precious water.",value:2,health:1,type:"consumable"}],ee=[{code:"fists",name:"Fists",quantity:1,level:0,randomDropWeight:0,description:"Your trusty haymakers.",type:"weapon",damage:1,range:1,value:0},{code:"torso",name:"Torso",quantity:1,level:0,randomDropWeight:0,description:"Your body, it's not much, but it’s all you have.",type:"armour",value:0,armour:0},{code:"head",name:"Head",quantity:1,level:0,randomDropWeight:0,description:"Your head, where all the thinking happens.",type:"helmet",value:0,armour:0},{code:"feet",name:"Feet",quantity:1,level:0,randomDropWeight:0,description:"Your feet, they carry you through life.",type:"shoes",value:0,armour:0}],te=ee.map(e=>D(e)),ae=J.map(e=>D(e)),oe=_.map(e=>D(e)),se=X.map(e=>D(e)),re=Z.map(e=>D(e)),U=[...te,...ae,...oe,...se,...re],G=e=>D({code:e.code(),name:e.name(),quantity:1,level:e.level(),randomDropWeight:e.randomDropWeight(),description:e.description(),value:e.value(),health:e.health(),type:e.type(),damage:e.damage(),range:e.range(),armour:e.armour(),maxArmour:e.maxArmour(),id:void 0}),ue=(e,t=1)=>{const a=U.find(r=>r.code()===e);if(!a)throw new Error(`Item with id ${e} not found`);return Array.from({length:t},()=>G(a))},L=(e,t)=>{const a=U.find(r=>r.code()===e);if(!a)throw new Error(`Item with id ${e} not found`);return G({...a,...t})},ne=(e,t)=>{const a=U.filter(r=>r.level()<=e&&r.level()>0);return Array.from({length:t},()=>{const r=a[Math.floor(Math.random()*a.length)];return G(r)})},R=e=>{const[t,a]=s(e),[r,i]=s(e.length===0);return{items:()=>t(),isEmpty:()=>r(),addItem:o=>{a(l=>[...l,o]),i(!1)},removeItem:o=>{const l=t().findIndex(d=>d.id()===o.id());a(d=>(l!==-1&&d.splice(l,1),d.length===0&&i(!0),d))},getItemById:o=>t().find(l=>l.id()===o),getItemByName:o=>t().find(l=>l.name()===o),getItemByCode:o=>t().find(l=>l.code()===o),isOnlyLoot:()=>t().every(o=>["loot","currency","light"].includes(o.type())),data:()=>t().map(o=>o.data())}};let H={npcsKilled:0,collectedItemsValue:0,tradedItemsValue:0,totalHealing:0,totalDamageTaken:0,totalDamageDealt:0,mostUsedWeapon:"fists",stepsTaken:0,eventsLooted:0,turns:0,npcsAlive:0,totalDamageAbsorbed:0,meleeAttacks:0,rangedAttacks:0};const j=()=>({reset:()=>{H={npcsKilled:0,collectedItemsValue:0,tradedItemsValue:0,totalHealing:0,totalDamageTaken:0,totalDamageDealt:0,mostUsedWeapon:"fists",stepsTaken:0,eventsLooted:0,turns:0,npcsAlive:0,totalDamageAbsorbed:0,meleeAttacks:0,rangedAttacks:0}},log:H,print:()=>{console.log(H),console.table(H)},load:r=>{H={...H,...r}}}),ie=e=>{var a,r,i,o;const t=((a=e.startingItems)==null?void 0:a.map(l=>D(l)))||[];return $({...e,startingItems:t,dialogues:e.dialogues||["Go away. I'm busy."],startingHealth:e.startingHealth,startingArmour:{body:(r=e.startingArmour)!=null&&r.body?D(e.startingArmour.body):void 0,head:(i=e.startingArmour)!=null&&i.head?D(e.startingArmour.head):void 0,feet:(o=e.startingArmour)!=null&&o.feet?D(e.startingArmour.feet):void 0},startingWeapon:e.startingWeapon?D(e.startingWeapon):void 0})},$=({id:e,name:t,team:a,startingSize:r=1,startPosition:i={x:0,y:0},startingItems:o=[],dialogues:l=["Go away. I'm busy."],startingHealth:d=5,startingMaxHealth:g=d,startingArmour:u={},startingWeapon:h=void 0})=>{const f=L("fists"),v=L("torso"),A=L("head"),I=L("feet"),[w,p]=s(i),[c,m]=s(d),[y]=s(R(o)),[W,S]=s(g),[T]=s(l),[M,E]=s("Go away. I'm busy."),[b,O]=s(!0),[x,N]=s(h??f),[P,V]=s(u.body??v),[B,k]=s(u.head??A),[C,q]=s(u.feet??I),[z]=s(r<1?1:r),K={id:()=>e,name:()=>t,team:()=>a,dialogue:()=>{const n=Math.floor(Math.random()*T().length);return E(T()[n]),M()},setDialogue:n=>E(n),updateTeam:n=>{n!==a&&(a=n)},isHostile:n=>a==="hostile-to-all"||a==="hostile-to-neutral"&&n!=="neutral"?!0:a==="hostile-to-player"&&n==="player",position:()=>({x:w().x,y:w().y,distanceTo:n=>{const F=n.x-w().x,Y=n.y-w().y;return Math.sqrt(F*F+Y*Y)}}),inventory:()=>y(),moveTo:(n,F)=>{K.id()==="player"&&(j().log.stepsTaken+=1),p({x:n,y:F})},health:()=>c(),setHealth:n=>{n<0?n=0:n>W()&&(n=W()),m(n)},maxHealth:()=>W(),visible:()=>b(),setVisible:n=>{O(n)},setMaxHealth:n=>{n<0&&(n=0),S(n),m(n)},bodyArmour:()=>P(),setBodyArmour:n=>{V(n||v)},headArmour:()=>B(),setHeadArmour:n=>{k(n||A)},feetArmour:()=>C(),setFeetArmour:n=>{q(n||I)},weapon:()=>x(),setWeapon:n=>{N(n||f)},size:()=>z(),data:()=>({id:e,name:t,team:a,startPosition:w(),startingItems:y().items().map(n=>n.data()),dialogues:T(),startingHealth:c(),startingArmour:{body:P()?P().data():void 0,head:B()?B().data():void 0,feet:C()?C().data():void 0},startingWeapon:x()?x().data():void 0,startingMaxHealth:W(),startingSize:z()})};return p(i),K},me=e=>{var a;const t=((a=e.startingItems)==null?void 0:a.map(r=>D(r)))||[];return le({...e,startingItems:t})},le=e=>{const{id:t,name:a,startPosition:r,startingItems:i=[],level:o}=e,[l]=s({x:r.x,y:r.y}),[d,g]=s(e.discovered??!1),[u]=s(R(i)),[h,f]=s(!0);return{id:()=>t,name:()=>a,level:()=>o,inventory:()=>u(),position:l,discovered:()=>d(),interact:()=>{d()||(g(!0),j().log.eventsLooted+=1)},visible:()=>h(),setVisible:v=>{f(v)},data:()=>({id:t,name:a,level:o,discovered:d(),startPosition:{x:l().x,y:l().y},startingItems:u().data()})}},Q=e=>{if(!e)return R([L("city-key")]);const t=5,a=new Array(t).fill(null).map((r,i)=>ne(t-i,i+1)).flat();return R(a)},he=e=>{const t=e.startingItems.map(a=>D(a));return de({...e,startingItems:t.length>0?t:void 0})},de=e=>{const{id:t,name:a,level:r,positions:i}=e,[o,l]=s(e.isUnlocked??!1),[d,g]=s(e.startingItems?R(e.startingItems):Q(o()));return{id:()=>t,name:()=>a,level:()=>r,positions:()=>i,isUnlocked:()=>o(),setIsUnlocked:u=>{u&&!o()&&g(Q(!0)),l(u)},inventory:()=>d(),setInventory:u=>g(u),data:()=>({id:t,name:a,level:r,positions:i.map(u=>({x:u.x,y:u.y})),isUnlocked:o(),startingItems:d().items().map(u=>u.data())})}},pe=e=>{const[t,a]=s(0),[r,i]=s(0),[o,l]=s([]),[d,g]=s([]),u=p=>{const c=d();c.includes(p)||(c.push(p),g([...c]))},h=p=>{const c=d(),m=c.indexOf(p);m!==-1&&(c.splice(m,1),g([...c]))},f=(p,c,m)=>{const y=o();y[p][c]=m,l([...y])},v=(p,c)=>{var m;return(m=o()[p])==null?void 0:m[c]},A=(p,c)=>[[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]].map(([y,W])=>v(p+y,c+W)).filter(Boolean),I=(p,c)=>{const m=v(p,c);return m!==void 0&&m.traversable()};if(e.length>0)a(e.length),i(e[0].length),l(e);else throw new Error("Tile map must have at least one tile");return(()=>{const p=o();for(let c=0;c<t();c++)for(let m=0;m<r();m++){const y=p[c][m],W=A(c,m);y.setEdges(W.map(S=>S.type())),y.setNeighbours(W)}})(),{horizontalCells:()=>t(),verticalCells:()=>r(),tiles:()=>o(),entryPoints:()=>d(),isValidMove:I,addEntryPoint:u,removeEntryPoint:h,updateTile:f,getTile:v,getNeighbors:A}},ge=e=>{const{terrain:t,corrupted:a=!1,discovered:r=!1,hasEvent:i=!1,hasEnemy:o=!1,structure:l,position:d}=e,[g]=s(t),[u,h]=s(r),[f,v]=s("HIDDEN"),[A]=s(a),[I]=s(l),[w,p]=s(!0),[c,m]=s(!1),[y,W]=s(!1),[S,T]=s(!1),[M,E]=s([]),[b,O]=s(e.edges??[]),x=()=>{const k=["water","mountain","sinkhole","forest","void"],C=["barricade"];return!k.includes(t)&&!C.includes(I())},N=()=>{h(!0),v(o?"DANGEROUS":"SAFE")},P=()=>{Math.random()<.3&&m(!0)},V=()=>{Math.random()<.3&&W(!0)},B=()=>{Math.random()<.05&&T(!0)};return(t==="wasteland"||t==="grass")&&P(),t==="void"&&(V(),B()),{type:()=>g(),position:()=>d,corrupted:()=>A(),structure:()=>I(),discovered:()=>u(),handleTileDiscovered:N,hasEvent:()=>i,hasEnemy:()=>o,state:()=>f(),traversable:x,visible:()=>w(),setVisible:k=>{p(k)},hasGrass:()=>c(),hasMud:()=>y(),hasEyes:()=>S(),neighbours:M,setNeighbours:k=>{E(k)},edges:()=>b(),setEdges:k=>{O(k)},data:()=>({terrain:g(),position:d,corrupted:A(),discovered:u(),hasEvent:i,hasEnemy:o,structure:I(),edges:b()})}},ve=e=>{const[t,a]=s((e==null?void 0:e.isEnabled)??!0),[r,i]=s((e==null?void 0:e.lightRadius)??224),[o,l]=s((e==null?void 0:e.fogOfWarPoints)??[]),[d,g]=s((e==null?void 0:e.revealedPoints)??[]);return{isEnabled:()=>t(),enable:h=>a(h),lightRadius:()=>r(),setLightRadius:h=>i(h),fogOfWarPoints:()=>o(),revealedPoints:()=>d(),addRevealedPoint:h=>{const f=d();f.some(v=>v.x===h.x&&v.y===h.y)||g([...f,h])},setFogOfWarPoints:h=>l(h),setRevealedPoints:h=>g(h),setToLowLight:()=>{i(128),a(!0)},setToFullLight:()=>{i(224),a(!0)},data:()=>({isEnabled:t(),lightRadius:r(),fogOfWarPoints:o(),revealedPoints:d()})}},ye=e=>{const t=ie(e),[a]=s(e.spawnling),[r,i]=s(e.lastTurnSpawned??0);return{...t,spawnling:()=>a(),lastTurnSpawned:()=>r(),setLastTurnSpawned:o=>{i(o)},data:()=>({...t.data(),spawnling:()=>{var o;return(o=a())==null?void 0:o.data()},lastTurnSpawned:()=>r()})}},fe=e=>{const t=$(e),[a]=s(e.spawnling),[r,i]=s(e.lastTurnSpawned??0);return{...t,spawnling:()=>a(),lastTurnSpawned:()=>r(),setLastTurnSpawned:o=>{i(o)},data:()=>({...t.data(),spawnling:()=>{var l;return(l=a())==null?void 0:l.data()},lastTurnSpawned:()=>r()})}};export{U as A,j as G,ye as a,me as b,he as c,ge as d,ve as e,pe as f,L as g,le as h,ue as i,$ as j,fe as k,ie as l,de as m,R as n};
