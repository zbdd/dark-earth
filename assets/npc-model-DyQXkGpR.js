import{c as s}from"./solid-lwVvZ318.js";const D=({code:e,name:t,randomDropWeight:a=50,description:r="No description provided",value:l=1,id:o,collected:d=!1,quantity:c=1,uses:p=0,level:i=1,health:f=0,type:v="loot",damage:y=0,range:A=0,armour:I=0,maxArmour:b})=>{const h=o??Math.random().toString(36).substring(2,15)+"-"+e,[u,m]=s(c),[g,w]=s(I),[S,T]=s(p),[M,E]=s(d);return{code:()=>e,id:()=>h,description:()=>r,randomDropWeight:()=>a,name:()=>t,level:()=>i,collected:()=>M(),setCollected:W=>{E(W)},quantity:()=>u(),value:()=>l,updateQuantity:W=>{m(W)},uses:()=>S(),setUses:W=>{W>=0&&T(W)},health:()=>f,type:()=>v,damage:()=>y,range:()=>A,armour:()=>g(),setArmour:W=>{W>=0&&w(W)},maxArmour:()=>b!==void 0?b:g(),data:()=>({code:e,name:t,randomDropWeight:a,description:r,value:l,quantity:u(),level:i,health:f,type:v,damage:y,range:A,armour:g(),id:h,maxArmour:b!==void 0?b:g(),uses:S(),collected:M()})}},_=[{code:"boots",name:"Boots",level:2,randomDropWeight:50,description:"Basic footwear providing limited protection.",value:1,armour:1,type:"shoes"},{code:"steel-toe-boots",name:"Steel-Toe Boots",level:3,randomDropWeight:25,description:"Heavy-duty boots with reinforced toes. Ideal for kicking and surviving.",value:6,armour:2,type:"shoes"},{code:"leather-sneakers",name:"Leather Sneakers",level:1,randomDropWeight:50,description:"Worn down but flexible. Better than walking barefoot.",value:2,type:"shoes"},{code:"military-greaves",name:"Military Greaves",level:4,randomDropWeight:15,description:"Surplus-grade lower leg armour. Scarred, but solid.",value:7,armour:3,type:"shoes"},{code:"plated-shinwraps",name:"Plated Shinwraps",level:2,randomDropWeight:30,description:"Wrapped in cloth and bolted with scrap metal plates.",value:4,armour:1,type:"shoes"},{code:"cultist-footwraps",name:"Cultist Footwraps",level:1,randomDropWeight:35,description:"Bandages soaked in oil and prayer. Not hygienic.",value:1,type:"loot"},{code:"hazmat-boots",name:"Hazmat Boots",level:3,randomDropWeight:20,description:"Rubberised boots with cracked soles. Resistant to gunk, not teeth.",value:3,armour:1,type:"shoes"},{code:"soggy-slippers",name:"Soggy Slippers",level:0,randomDropWeight:60,description:"Wet, floppy, and morally offensive. Someone still wore these.",value:1,type:"loot"},{code:"tire-tread-sandals",name:"Tire-Tread Sandals",level:2,randomDropWeight:40,description:"Crafted from old tires and wire. Surprisingly durable.",value:3,armour:1,type:"shoes"},{code:"reinforced-waders",name:"Reinforced Waders",level:3,randomDropWeight:25,description:"Heavy waterproof boots reinforced with rivets and curses.",value:5,armour:2,type:"shoes"},{code:"ceremonial-toe-rings",name:"Ceremonial Toe Rings",level:0,randomDropWeight:45,description:"Technically footwear. Spiritually disappointing.",value:1,type:"loot"},{code:"leather-tunic",name:"Leather Tunic",level:4,randomDropWeight:40,description:"A tunic made of leather, providing basic protection.",value:3,armour:1,type:"armour"},{code:"rusted-helm",name:"Rusted Helm",level:2,randomDropWeight:40,description:"A dented steel helmet from a bygone war. Still offers some protection.",value:3,armour:1,type:"helmet"},{code:"riot-visor",name:"Cracked Riot Visor",level:3,randomDropWeight:30,description:"Half of a riot helmet. The visor is shattered but still provides some defense.",value:4,armour:2,type:"helmet"},{code:"makeshift-helmet",name:"Makeshift Helmet",level:2,randomDropWeight:35,description:"A cooking pot with leather straps. Better than nothing, barely.",value:2,armour:1,type:"helmet"},{code:"military-helmet",name:"Old Military Helmet",level:4,randomDropWeight:15,description:"Kevlar-lined and surprisingly intact. Offers solid protection.",value:7,armour:3,type:"helmet"},{code:"metal-faceplate",name:"Metal Faceplate",level:3,randomDropWeight:20,description:"Welded scrap formed into a crude faceguard. Heavy but effective.",value:4,armour:2,type:"helmet"},{code:"bucket-head",name:"Bucket Head",level:1,randomDropWeight:45,description:"It’s literally just a bucket. Slightly muffles voices and incoming rocks.",value:1,armour:1,type:"helmet"}],J=[{code:"torch",name:"Torch",level:1,randomDropWeight:70,description:"A source of light.",value:.1,type:"light"},{code:"coin",name:"Coin",level:1,randomDropWeight:90,description:"Used to purchase items.",value:1,type:"currency"},{code:"ichor",name:"Ichor",level:8,randomDropWeight:10,description:"A valuable substance used by apothecaries.",value:10},{code:"seedling",name:"Seedling",level:7,randomDropWeight:20,description:"Extremely valuable essence of new life.",value:15},{code:"antigen",name:"Antigen",level:5,randomDropWeight:30,description:"A substance that stimulates the production of antibodies.",value:5},{code:"light-shard",name:"Light Shard",level:10,randomDropWeight:5,description:"A shard of pure light.",value:100},{code:"shirt",name:"Shirt",level:3,randomDropWeight:60,description:"A basic shirt.",value:1},{code:"scavenger-hood",name:"Scavenger Hood",level:1,randomDropWeight:50,description:"A makeshift hood sewn from scraps and duct tape. Blocks sunlight, not bullets.",value:1,type:"loot"},{code:"cult-mask",name:"Bone Cult Mask",level:2,randomDropWeight:20,description:"A decorative skull mask worn by wasteland cultists. Intimidating, not useful.",value:2,type:"loot"},{code:"bandana",name:"Worn Bandana",level:0,randomDropWeight:60,description:"Faded and threadbare. A nod to fashion, not function.",value:1,type:"loot"},{code:"hazmat-hood",name:"Hazmat Hood (Torn)",level:3,randomDropWeight:25,description:"A scorched hood from an old hazmat suit. Still filters some toxins.",value:5,type:"loot"}],X=[{code:"spear",name:"Spear",level:3,randomDropWeight:40,description:"A long weapon for thrusting.",value:2,type:"weapon",damage:1,range:2},{code:"knuckle-duster",name:"Knuckle Duster",level:3,randomDropWeight:40,description:"A metal knuckle for close combat.",value:2,type:"weapon",damage:2,range:1},{code:"sword",name:"Sword",level:5,randomDropWeight:30,description:"A sharp blade for slashing.",value:6,type:"weapon",damage:3,range:1},{code:"knife",name:"Knife",level:2,randomDropWeight:50,description:"A sharp blade for cutting.",value:1,type:"weapon",damage:2,range:1},{code:"bow",name:"Bow",level:4,randomDropWeight:35,description:"A good ranged weapon.",value:3,type:"weapon",damage:2,range:3}],Z=[{code:"healing-potion",name:"Healing Potion",level:3,randomDropWeight:50,description:"A potion that restores health.",value:6,health:3,type:"consumable"},{code:"city-key",name:"City Key",type:"key",level:0,randomDropWeight:0,description:"A key that unlocks the city gates.",value:0},{code:"waterskin",name:"Waterskin",level:2,randomDropWeight:60,description:"Contains precious water.",value:2,health:1,type:"consumable"}],ee=[{code:"fists",name:"Fists",quantity:1,level:0,randomDropWeight:0,description:"Your trusty haymakers.",type:"weapon",damage:1,range:1,value:0},{code:"torso",name:"Torso",quantity:1,level:0,randomDropWeight:0,description:"Your body, it's not much, but it’s all you have.",type:"armour",value:0,armour:0},{code:"head",name:"Head",quantity:1,level:0,randomDropWeight:0,description:"Your head, where all the thinking happens.",type:"helmet",value:0,armour:0},{code:"feet",name:"Feet",quantity:1,level:0,randomDropWeight:0,description:"Your feet, they carry you through life.",type:"shoes",value:0,armour:0}],te=ee.map(e=>D(e)),ae=J.map(e=>D(e)),oe=_.map(e=>D(e)),se=X.map(e=>D(e)),re=Z.map(e=>D(e)),q=[...te,...ae,...oe,...se,...re],z=e=>D({code:e.code(),name:e.name(),quantity:1,level:e.level(),randomDropWeight:e.randomDropWeight(),description:e.description(),value:e.value(),health:e.health(),type:e.type(),damage:e.damage(),range:e.range(),armour:e.armour(),maxArmour:e.maxArmour(),id:void 0}),ue=(e,t=1)=>{const a=q.find(r=>r.code()===e);if(!a)throw new Error(`Item with id ${e} not found`);return Array.from({length:t},()=>z(a))},L=(e,t)=>{const a=q.find(r=>r.code()===e);if(!a)throw new Error(`Item with id ${e} not found`);return z({...a,...t})},ne=(e,t)=>{const a=q.filter(r=>r.level()<=e&&r.level()>0);return Array.from({length:t},()=>{const r=a[Math.floor(Math.random()*a.length)];return z(r)})},R=e=>{const[t,a]=s(e),[r,l]=s(e.length===0);return{items:()=>t(),isEmpty:()=>r(),addItem:o=>{a(d=>[...d,o]),l(!1)},removeItem:o=>{const d=t().findIndex(c=>c.id()===o.id());a(c=>(d!==-1&&c.splice(d,1),c.length===0&&l(!0),c))},getItemById:o=>t().find(d=>d.id()===o),getItemByName:o=>t().find(d=>d.name()===o),getItemByCode:o=>t().find(d=>d.code()===o),isOnlyLoot:()=>t().every(o=>["loot","currency","light"].includes(o.type())),data:()=>t().map(o=>o.data())}};let x={npcsKilled:0,collectedItemsValue:0,tradedItemsValue:0,totalHealing:0,totalDamageTaken:0,totalDamageDealt:0,mostUsedWeapon:"fists",stepsTaken:0,eventsLooted:0,turns:0,npcsAlive:0,totalDamageAbsorbed:0,meleeAttacks:0,rangedAttacks:0};const j=()=>({reset:()=>{x={npcsKilled:0,collectedItemsValue:0,tradedItemsValue:0,totalHealing:0,totalDamageTaken:0,totalDamageDealt:0,mostUsedWeapon:"fists",stepsTaken:0,eventsLooted:0,turns:0,npcsAlive:0,totalDamageAbsorbed:0,meleeAttacks:0,rangedAttacks:0}},log:x,print:()=>{console.log(x),console.table(x)},load:r=>{x={...x,...r}}}),ie=e=>{var a,r,l,o;const t=((a=e.startingItems)==null?void 0:a.map(d=>D(d)))||[];return $({...e,startingItems:t,dialogues:e.dialogues||["Go away. I'm busy."],startingHealth:e.startingHealth,startingArmour:{body:(r=e.startingArmour)!=null&&r.body?D(e.startingArmour.body):void 0,head:(l=e.startingArmour)!=null&&l.head?D(e.startingArmour.head):void 0,feet:(o=e.startingArmour)!=null&&o.feet?D(e.startingArmour.feet):void 0},startingWeapon:e.startingWeapon?D(e.startingWeapon):void 0})},$=({id:e,name:t,team:a,startingSize:r=1,startPosition:l={x:0,y:0},startingItems:o=[],dialogues:d=["Go away. I'm busy."],startingHealth:c=5,startingMaxHealth:p=c,startingArmour:i={},startingWeapon:f=void 0})=>{const v=L("fists"),y=L("torso"),A=L("head"),I=L("feet"),[b,h]=s(l),[u,m]=s(c),[g]=s(R(o)),[w,S]=s(p),[T]=s(d),[M,E]=s("Go away. I'm busy."),[W,G]=s(!0),[H,N]=s(f??v),[P,V]=s(i.body??y),[B,F]=s(i.head??A),[C,k]=s(i.feet??I),[O]=s(r<1?1:r),K={id:()=>e,name:()=>t,team:()=>a,dialogue:()=>{const n=Math.floor(Math.random()*T().length);return E(T()[n]),M()},setDialogue:n=>E(n),updateTeam:n=>{n!==a&&(a=n)},isHostile:n=>a==="hostile-to-all"||a==="hostile-to-neutral"&&n!=="neutral"?!0:a==="hostile-to-player"&&n==="player",position:()=>({x:b().x,y:b().y,distanceTo:n=>{const U=n.x-b().x,Y=n.y-b().y;return Math.sqrt(U*U+Y*Y)}}),inventory:()=>g(),moveTo:(n,U)=>{K.id()==="player"&&(j().log.stepsTaken+=1),h({x:n,y:U})},health:()=>u(),setHealth:n=>{n<0?n=0:n>w()&&(n=w()),m(n)},maxHealth:()=>w(),visible:()=>W(),setVisible:n=>{G(n)},setMaxHealth:n=>{n<0&&(n=0),S(n),m(n)},bodyArmour:()=>P(),setBodyArmour:n=>{V(n||y)},headArmour:()=>B(),setHeadArmour:n=>{F(n||A)},feetArmour:()=>C(),setFeetArmour:n=>{k(n||I)},weapon:()=>H(),setWeapon:n=>{N(n||v)},size:()=>O(),data:()=>({id:e,name:t,team:a,startPosition:b(),startingItems:g().items().map(n=>n.data()),dialogues:T(),startingHealth:u(),startingArmour:{body:P()?P().data():void 0,head:B()?B().data():void 0,feet:C()?C().data():void 0},startingWeapon:H()?H().data():void 0,startingMaxHealth:w(),startingSize:O()})};return h(l),K},me=e=>{var a;const t=((a=e.startingItems)==null?void 0:a.map(r=>D(r)))||[];return le({...e,startingItems:t})},le=e=>{const{id:t,name:a,startPosition:r,startingItems:l=[],level:o}=e,[d]=s({x:r.x,y:r.y}),[c,p]=s(e.discovered??!1),[i]=s(R(l)),[f,v]=s(!0);return{id:()=>t,name:()=>a,level:()=>o,inventory:()=>i(),position:d,discovered:()=>c(),interact:()=>{c()||(p(!0),j().log.eventsLooted+=1)},visible:()=>f(),setVisible:y=>{v(y)},data:()=>({id:t,name:a,level:o,discovered:c(),startPosition:{x:d().x,y:d().y},startingItems:i().data()})}},Q=e=>{if(!e)return R([L("city-key")]);const t=5,a=new Array(t).fill(null).map((r,l)=>ne(t-l,l+1)).flat();return R(a)},he=e=>{const t=e.startingItems.map(a=>D(a));return de({...e,startingItems:t.length>0?t:void 0})},de=e=>{const{id:t,name:a,level:r,positions:l}=e,[o,d]=s(e.isUnlocked??!1),[c,p]=s(e.startingItems?R(e.startingItems):Q(o()));return{id:()=>t,name:()=>a,level:()=>r,positions:()=>l,isUnlocked:()=>o(),setIsUnlocked:i=>{i&&!o()&&p(Q(!0)),d(i)},inventory:()=>c(),setInventory:i=>p(i),data:()=>({id:t,name:a,level:r,positions:l.map(i=>({x:i.x,y:i.y})),isUnlocked:o(),startingItems:c().items().map(i=>i.data())})}},pe=e=>{const[t,a]=s(0),[r,l]=s(0),[o,d]=s([]),[c,p]=s([]),i=h=>{const u=c();u.includes(h)||(u.push(h),p([...u]))},f=h=>{const u=c(),m=u.indexOf(h);m!==-1&&(u.splice(m,1),p([...u]))},v=(h,u,m)=>{const g=o();g[h][u]=m,d([...g])},y=(h,u)=>{var m;return(m=o()[h])==null?void 0:m[u]},A=(h,u)=>[[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]].map(([g,w])=>y(h+g,u+w)).filter(Boolean),I=(h,u)=>{const m=y(h,u);return m!==void 0&&m.traversable()};if(e.length>0)a(e.length),l(e[0].length),d(e);else throw new Error("Tile map must have at least one tile");return(()=>{const h=o();for(let u=0;u<t();u++)for(let m=0;m<r();m++){const g=h[u][m],w=A(u,m);g.setEdges(w.map(S=>S.type())),g.setNeighbours(w)}})(),{horizontalCells:()=>t(),verticalCells:()=>r(),tiles:()=>o(),entryPoints:()=>c(),isValidMove:I,addEntryPoint:i,removeEntryPoint:f,updateTile:v,getTile:y,getNeighbors:A}},ge=e=>{const{terrain:t,corrupted:a=!1,discovered:r=!1,hasEvent:l=!1,hasEnemy:o=!1,structure:d,position:c}=e,[p]=s(t),[i,f]=s(r),[v,y]=s("HIDDEN"),[A]=s(a),[I]=s(d),[b,h]=s(!0),[u,m]=s(!1),[g,w]=s(!1),[S,T]=s(!1),[M,E]=s([]),[W,G]=s(!1),[H,N]=s(e.edges??[]),P=()=>{const k=["water","mountain","sinkhole","forest","void"],O=["barricade"];return!k.includes(t)&&!O.includes(I())},V=()=>{f(!0),y(o?"DANGEROUS":"SAFE")},B=()=>{Math.random()<.3&&m(!0)},F=()=>{Math.random()<.3&&w(!0)},C=()=>{Math.random()<.05&&T(!0)};return(t==="wasteland"||t==="grass")&&B(),t==="void"&&(F(),C()),{type:()=>p(),position:()=>c,corrupted:()=>A(),structure:()=>I(),discovered:()=>i(),handleTileDiscovered:V,hasEvent:()=>l,hasEnemy:()=>o,state:()=>v(),traversable:P,visible:()=>b(),setVisible:k=>{h(k)},hasGrass:()=>u(),hasMud:()=>g(),hasEyes:()=>S(),neighbours:M,setNeighbours:k=>{E(k)},edges:()=>H(),setEdges:k=>{N(k)},isSelected:W,setIsSelected:G,data:()=>({terrain:p(),position:c,corrupted:A(),discovered:i(),hasEvent:l,hasEnemy:o,structure:I(),edges:H()})}},ve=e=>{const[t,a]=s((e==null?void 0:e.isEnabled)??!0),[r,l]=s((e==null?void 0:e.lightRadius)??224),[o,d]=s((e==null?void 0:e.fogOfWarPoints)??[]),[c,p]=s((e==null?void 0:e.revealedPoints)??[]);return{isEnabled:()=>t(),enable:i=>a(i),lightRadius:()=>r(),setLightRadius:i=>l(i),fogOfWarPoints:()=>o(),revealedPoints:()=>c(),addRevealedPoint:i=>{const f=c();f.some(v=>v.x===i.x&&v.y===i.y)||p([...f,i])},setFogOfWarPoints:i=>d(i),setRevealedPoints:i=>p(i),setToLowLight:()=>{l(128),a(!0)},setToFullLight:()=>{l(224),a(!0)},data:()=>({isEnabled:t(),lightRadius:r(),fogOfWarPoints:o(),revealedPoints:c()})}},ye=e=>{const t=ie(e),[a]=s(e.spawnling),[r,l]=s(e.lastTurnSpawned??0);return{...t,spawnling:()=>a(),lastTurnSpawned:()=>r(),setLastTurnSpawned:o=>{l(o)},data:()=>({...t.data(),spawnling:()=>{var o;return(o=a())==null?void 0:o.data()},lastTurnSpawned:()=>r()})}},fe=e=>{const t=$(e),[a]=s(e.spawnling),[r,l]=s(e.lastTurnSpawned??0);return{...t,spawnling:()=>a(),lastTurnSpawned:()=>r(),setLastTurnSpawned:o=>{l(o)},data:()=>({...t.data(),spawnling:()=>{var d;return(d=a())==null?void 0:d.data()},lastTurnSpawned:()=>r()})}};export{q as A,j as G,ye as a,me as b,he as c,ge as d,ve as e,pe as f,L as g,le as h,ue as i,$ as j,fe as k,ie as l,de as m,R as n};
