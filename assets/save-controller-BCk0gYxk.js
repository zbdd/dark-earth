import{l as v,c as M,a as y,b,d as D,e as L,f as I,G as n}from"./npc-model-BqrqNmcU.js";import"./solid-lwVvZ318.js";const N=()=>{const m=()=>{console.debug("Clearing saved game...");try{const e=localStorage.getItem("gameLog"),a=localStorage.getItem("gameState");e&&localStorage.setItem("gameLog_backup",e),a&&localStorage.setItem("gameState_backup",a)}catch{console.debug("Unable to backup saved game")}try{localStorage.removeItem("gameState"),localStorage.removeItem("gameLog"),console.debug("Saved game cleared successfully.")}catch(e){console.error("Error clearing saved game:",e)}},d=()=>{console.debug("Saving game log...");const e=n().log,a=JSON.stringify(e);try{localStorage.setItem("gameLog",a)}catch(t){console.error("Error saving game log:",t)}},i=e=>{console.debug("Saving game...");const{playerModel:a,npcModels:t,eventModels:r,settlementModels:l,tileModels:s,fogOfWarViewModel:g}=e,c=JSON.stringify({playerData:a.data(),npcData:t.map(o=>o.data()),eventData:r.map(o=>o.data()),settlementData:l.map(o=>o.data()),tileData:s.map(o=>o.map(f=>f.data())),fogOfWarData:g.data()});try{localStorage.setItem("gameState",c)}catch(o){console.error("Error saving game state:",o);return}d(),console.debug("Game saved successfully.")},p=()=>{console.debug("Loading game log...");const e=localStorage.getItem("gameLog");if(!e){console.warn("No saved game log found.");return}try{const a=JSON.parse(e);n().load(a),console.debug("Game log loaded successfully.")}catch(a){console.error("Error loading game log:",a)}},u=()=>{console.debug("Loading game...");const e=localStorage.getItem("gameState");if(!e){console.warn("No saved game state found.");return}try{const a=JSON.parse(e),t=S(a);return console.debug("Game loaded successfully."),p(),t}catch(a){console.error("Error loading game state:",a);return}},S=e=>{const a=v(e.playerData),t=e.npcData.map(M),r=e.eventData.map(y),l=e.settlementData.map(b),s=e.tileData.map(c=>c.map(D)),g=L(e.fogOfWarData);return{playerModel:a,npcModels:t,eventModels:r,settlementModels:l,tileMapModel:I(s),fogOfWarViewModel:g}};return{save:i,load:u,clear:m}};export{N as createSaveController};
