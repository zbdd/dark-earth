import{c as x,g as d,S as f}from"./sound-manager-yHYP5k4c.js";import{C as y,S as c,T as I}from"./index-CB6H2Qef.js";import{a as C}from"./solid-lwVvZ318.js";const j=m=>{const{viewModel:t}=m,i=new y;let p=()=>{};i.label="loading-screen-view",i.visible=!1,i.eventMode="static",i.on("pointertap",()=>{p()});const s=c.from("load-level.jpg");s.label="loading-screen-sprite";const r=c.from("loading-screen-settlement.jpg");r.label="loading-screen-settlement-sprite",r.visible=t.isRestScreenVisible();const l=[c.from("intro-1.jpg"),c.from("intro-2.jpg"),c.from("intro-3.jpg"),c.from("intro-4.jpg")],o=new I;o.label="loading-screen-title",o.text=t.text(),o.style={fontFamily:"alagard",fontSize:48,fill:"#ffffff",align:"center",stroke:"#000000",dropShadow:!0},o.position.set(s.width*.5-o.width*.5,s.height*.2+o.height*.5),i.addChild(s,o,r),l.forEach((e,n)=>{e.label=`intro-screen-sprite-${n+1}`,e.visible=!1,i.addChild(e)});const S=()=>{t.isRestScreenVisible()?f.playMusic("mx-level-end.wav",{fadeIn:!0,fadeOut:!0}):t.isIntroSequencePlaying()?f.playMusic("mx-intro.mp3",{fadeIn:!0,fadeOut:!0}):f.playMusic("dark drop off trim.wav",{volume:1,fadeIn:!0,fadeOut:!0})},h=()=>{i.alpha=0,i.visible=!0,d.to(i,{alpha:1,duration:r.visible?6:1,ease:"power2.inOut"})},u=()=>{d.to(i,{alpha:0,duration:1,ease:"power2.inOut",onComplete:()=>{i.visible=!1}})},g=(e,n)=>{const a=Math.min(e/s.width,n/s.height);i.scale.set(a),i.position.set((e-s.width*a)*.5,(n-s.height*a)*.5)},v=async e=>{o.text="";const n=e.split("");for(const a of n)o.text+=a,await new Promise(w=>setTimeout(w,100));t.setText(e)},b=async()=>{for(const e of l){const n=l.indexOf(e);e.visible=!0,e.alpha=0,e.position.set((s.width-e.width)*.5,(s.height-e.height)*.5),await d.to(e,{alpha:1,duration:1,ease:"power2.inOut"}),await new Promise(a=>{d.delayedCall(4,()=>a()),p=()=>a()}),n===l.length-1&&t.isIntroSequencePlaying()&&t.setIntroSequencePlaying(!1)}};return x(()=>{C(()=>{if(g(innerWidth,innerHeight),!i.visible&&t.isVisible()){t.isIntroSequencePlaying()?b():(l.slice(0,3).forEach(n=>n.visible=!1),d.to(l[3],{alpha:0,duration:1,ease:"power2.inOut"})),r.visible=t.isRestScreenVisible(),s.visible=!r.visible,S(),h();const e=t.text();v(e)}else i.visible&&!t.isVisible()&&u()})},i),{view:i,show:h,hide:u,resize:g}};export{j as createLoadingScreenView};
