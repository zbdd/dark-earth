import{l as M,a as b,b as y,c as D,d as L,e as I,f as O,G as n}from"./npc-model-CAMnkFmP.js";import"./solid-lwVvZ318.js";const E=()=>{const m=()=>{console.debug("Clearing saved game...");try{const e=localStorage.getItem("gameLog"),a=localStorage.getItem("gameState");e&&localStorage.setItem("gameLog_backup",e),a&&localStorage.setItem("gameState_backup",a)}catch{console.debug("Unable to backup saved game")}try{localStorage.removeItem("gameState"),localStorage.removeItem("gameLog"),console.debug("Saved game cleared successfully.")}catch(e){console.error("Error clearing saved game:",e)}},d=()=>{console.debug("Saving game log...");const e=n().log,a=JSON.stringify(e);try{localStorage.setItem("gameLog",a)}catch(t){console.error("Error saving game log:",t)}},u=e=>{console.debug("Saving game...");const{playerModel:a,npcModels:t,eventModels:r,settlementModels:l,tileModels:s,fogOfWarViewModel:g}=e,c=JSON.stringify({playerData:a.data(),npcData:t.map(o=>o.data()),eventData:r.map(o=>o.data()),settlementData:l.map(o=>o.data()),tileData:s.map(o=>o.map(v=>v.data())),fogOfWarData:g.data()});try{localStorage.setItem("gameState",c)}catch(o){console.error("Error saving game state:",o);return}d(),console.debug("Game saved successfully.")},i=()=>{console.debug("Loading game log...");const e=localStorage.getItem("gameLog");if(!e){console.warn("No saved game log found.");return}try{const a=JSON.parse(e);n().load(a),console.debug("Game log loaded successfully.")}catch(a){console.error("Error loading game log:",a)}},S=()=>(console.debug("Checking if saved game exists..."),localStorage.getItem("gameState")?(console.debug("Saved game found."),!0):(console.debug("No saved game found."),!1)),f=()=>{console.debug("Loading game...");const e=localStorage.getItem("gameState");if(!e){console.warn("No saved game state found.");return}try{const a=JSON.parse(e),t=p(a);return console.debug("Game loaded successfully."),i(),t}catch(a){console.error("Error loading game state:",a);return}},p=e=>{const a=M(e.playerData),t=e.npcData.map(b),r=e.eventData.map(y),l=e.settlementData.map(D),s=e.tileData.map(c=>c.map(L)),g=I(e.fogOfWarData);return{playerModel:a,npcModels:t,eventModels:r,settlementModels:l,tileMapModel:O(s),fogOfWarViewModel:g}};return{save:u,load:f,clear:m,saveExists:S}};export{E as createSaveController};
